(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[634],{44:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var n=r(7876),o=r(4232),s=r(9099),a=r(7685);function l(){let e=(0,s.useRouter)(),[t,r]=(0,o.useState)("provider"),[l,i]=(0,o.useState)(""),[d,c]=(0,o.useState)(""),[u,h]=(0,o.useState)(""),[g,m]=(0,o.useState)(1),[b,p]=(0,o.useState)(!1),x=async()=>{if(!l.startsWith("+961"))return void a.Ay.error("Please use a valid Lebanese number (+961...)");p(!0);try{let e=await fetch("https://khedme-api.onrender.com/auth/request-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({phone:l,role:t})}),r=await e.json();if(!e.ok)throw Error(r.message);a.Ay.success(r.message||"OTP sent ✅"),h(r.providerId||""),m(2)}catch(e){a.Ay.error(e.message||"Something went wrong ❌")}finally{p(!1)}},f=async()=>{if(!d.trim())return void a.Ay.error("Enter the OTP code");p(!0);try{let r=await fetch("https://khedme-api.onrender.com/auth/verify-otp",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({providerId:u,otp:d})}),n=await r.json();if(!r.ok)throw Error(n.message);a.Ay.success("Phone verified successfully \uD83C\uDF89"),localStorage.setItem("providerId",u),localStorage.setItem("phone",l),localStorage.setItem("role",t),m(3),setTimeout(()=>{"provider"===t?e.push("/provider"):e.push("/post-job")},1500)}catch(e){a.Ay.error(e.message||"Invalid OTP ❌")}finally{p(!1)}};return(0,n.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-orange-600 to-black text-white px-4",children:[(0,n.jsx)(a.l$,{position:"top-center",toastOptions:{style:{background:"#FF6600",color:"white",fontWeight:"bold",borderRadius:"10px"}}}),(0,n.jsxs)("div",{className:"bg-black/50 p-8 rounded-2xl shadow-2xl w-full max-w-md text-center backdrop-blur-md",children:[1===g&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Sign in to Khedme"}),(0,n.jsxs)("div",{className:"flex justify-center gap-3 mb-6",children:[(0,n.jsx)("button",{className:`px-4 py-2 rounded-lg font-semibold transition-all ${"provider"===t?"bg-orange-500 text-white":"bg-gray-200 text-black hover:bg-gray-300"}`,onClick:()=>r("provider"),children:"Provider"}),(0,n.jsx)("button",{className:`px-4 py-2 rounded-lg font-semibold transition-all ${"client"===t?"bg-orange-500 text-white":"bg-gray-200 text-black hover:bg-gray-300"}`,onClick:()=>r("client"),children:"Client"})]}),(0,n.jsx)("input",{type:"tel",placeholder:"+961XXXXXXXX",value:l,onChange:e=>i(e.target.value),onKeyDown:e=>"Enter"===e.key&&x(),className:"w-full p-3 rounded-lg mb-4 text-black focus:ring-2 focus:ring-orange-400 outline-none"}),(0,n.jsx)("button",{onClick:x,disabled:b,className:"bg-orange-500 hover:bg-orange-600 w-full py-3 rounded-lg font-semibold transition-all disabled:opacity-70",children:b?"Sending...":`Request OTP (${t})`})]}),2===g&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Enter OTP"}),(0,n.jsx)("input",{type:"text",placeholder:"123456",value:d,onChange:e=>c(e.target.value),onKeyDown:e=>"Enter"===e.key&&f(),className:"w-full p-3 rounded-lg mb-4 text-black focus:ring-2 focus:ring-orange-400 outline-none"}),(0,n.jsx)("button",{onClick:f,disabled:b,className:"bg-orange-500 hover:bg-orange-600 w-full py-3 rounded-lg font-semibold transition-all disabled:opacity-70",children:b?"Verifying...":"Verify OTP"}),(0,n.jsx)("button",{onClick:()=>m(1),className:"mt-4 text-orange-300 hover:underline text-sm",children:"← Change phone number"})]}),3===g&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-2 text-green-400",children:"✅ Verified!"}),(0,n.jsx)("p",{className:"text-gray-200",children:"Welcome to Khedme"})]})]})]})}},556:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/auth",function(){return r(44)}])}},e=>{e.O(0,[636,593,792],()=>e(e.s=556)),_N_E=e.O()}]);