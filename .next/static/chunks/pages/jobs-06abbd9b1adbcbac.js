(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[232],{150:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>o});var a=t(7876),r=t(4232),i=t(7685);function o(){let e="https://khedme-api.onrender.com",[s,t]=(0,r.useState)([]),[o,l]=(0,r.useState)(!0),[d,n]=(0,r.useState)({});(0,r.useEffect)(()=>{(async()=>{try{let s=await fetch(`${e}/api/jobs/all`);if(!s.ok)throw Error("Failed to fetch jobs");let a=await s.json();t(a.jobs||[])}catch(e){console.error("Job load error:",e),i.Ay.error("Failed to load jobs")}finally{l(!1)}})()},[]);let c=async s=>{n(e=>({...e,[s]:!0}));try{let t=await fetch(`${e}/api/jobs/apply`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({job_id:s,provider_id:1,message:"Hello — I can take this job."})}),a=await t.json();if(!t.ok)throw Error(a.error||"Failed to apply");i.Ay.success("Application sent ✅")}catch(e){console.error("Apply error:",e),i.Ay.error(e.message||"Error applying")}finally{n(e=>({...e,[s]:!1}))}};return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 p-6",children:(0,a.jsxs)("div",{className:"max-w-5xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-orange-600 mb-6",children:"Open Jobs"}),o?(0,a.jsx)("p",{className:"text-gray-500",children:"Loading jobs…"}):0===s.length?(0,a.jsx)("p",{className:"text-gray-500",children:"No jobs posted yet."}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:s.map(e=>(0,a.jsxs)("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-orange-50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:e.service||"Service"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:["District:"," ",(0,a.jsx)("span",{className:"font-medium",children:e.district||"—"})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-lg font-bold text-orange-600",children:["$",e.budget||"—"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-400",children:["Posted:"," ",e.created_at?new Date(e.created_at).toLocaleDateString():"—"]})]})]}),(0,a.jsx)("div",{className:"mt-4",children:(0,a.jsx)("button",{disabled:!!d[e.id],onClick:()=>c(e.id),className:`w-full rounded-xl py-2 font-medium transition ${d[e.id]?"bg-gray-300 text-gray-700 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600 text-white"}`,children:d[e.id]?"Applying...":"Apply Now"})})]},e.id))})]})})}},5684:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/jobs",function(){return t(150)}])}},e=>{e.O(0,[636,593,792],()=>e(e.s=5684)),_N_E=e.O()}]);