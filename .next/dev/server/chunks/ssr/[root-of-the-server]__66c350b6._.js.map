{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///D:/Khedme/Khedme-Web/src/pages/provider/profile.js"],"sourcesContent":["// src/pages/provider/profile.js\r\nimport { useState, useEffect } from \"react\";\r\nimport { useRouter } from \"next/router\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nexport default function ProviderProfile() {\r\n  const router = useRouter();\r\n  const API_BASE = \"https://khedme-api.onrender.com\";\r\n\r\n  const [provider, setProvider] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n\r\n  // ‚úÖ Load provider from localStorage or redirect\r\n  useEffect(() => {\r\n    const stored = localStorage.getItem(\"provider\");\r\n    if (!stored) {\r\n      toast.error(\"Please log in first\");\r\n      router.push(\"/provider/login\");\r\n    } else {\r\n      const parsed = JSON.parse(stored);\r\n      setProvider(parsed);\r\n    }\r\n  }, [router]);\r\n\r\n  // ‚úÖ Fetch profile from backend after login\r\n  const fetchProfile = async () => {\r\n    if (!provider?.id) return;\r\n    try {\r\n      const res = await fetch(`${API_BASE}/api/providers/${provider.id}`);\r\n      const data = await res.json();\r\n\r\n      if (data.success && data.provider) {\r\n        setProvider(data.provider);\r\n      } else {\r\n        toast.error(\"Failed to load profile\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"‚ùå Error fetching provider:\", err);\r\n      toast.error(\"Error fetching profile\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (provider?.id) fetchProfile();\r\n  }, [provider?.id]);\r\n\r\n  // ‚úÖ Save profile updates\r\n  const saveProfile = async (e) => {\r\n    e.preventDefault();\r\n    setSaving(true);\r\n    try {\r\n      const res = await fetch(`${API_BASE}/api/providers/update`, {\r\n        method: \"PUT\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(provider),\r\n      });\r\n\r\n      const data = await res.json();\r\n      if (data.success) {\r\n        toast.success(\"Profile updated ‚úÖ\");\r\n        localStorage.setItem(\"provider\", JSON.stringify(provider)); // keep in sync\r\n      } else {\r\n        toast.error(\"Failed to update\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"‚ùå Error saving profile:\", err);\r\n      toast.error(\"Error updating profile\");\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  // ‚úÖ Toggle availability\r\n  const toggleAvailability = async () => {\r\n    try {\r\n      const res = await fetch(`${API_BASE}/api/providers/update`, {\r\n        method: \"PUT\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({\r\n          id: provider.id,\r\n          available: !provider.available,\r\n        }),\r\n      });\r\n\r\n      const data = await res.json();\r\n      if (data.success) {\r\n        const updated = { ...provider, available: !provider.available };\r\n        setProvider(updated);\r\n        localStorage.setItem(\"provider\", JSON.stringify(updated));\r\n        toast.success(\r\n          `Now marked as ${updated.available ? \"available ‚úÖ\" : \"unavailable ‚õî\"}`\r\n        );\r\n      } else toast.error(\"Failed to update availability\");\r\n    } catch (err) {\r\n      console.error(\"‚ùå Toggle error:\", err);\r\n      toast.error(\"Error toggling availability\");\r\n    }\r\n  };\r\n\r\n  // üß± UI\r\n  if (loading || !provider)\r\n    return <p className=\"text-center mt-10 text-gray-500\">Loading...</p>;\r\n\r\n  return (\r\n    <div className=\"max-w-lg mx-auto p-6 bg-white rounded-2xl shadow-md mt-10\">\r\n      <h1 className=\"text-2xl font-semibold text-orange-600 mb-6 text-center\">\r\n        Provider Profile\r\n      </h1>\r\n\r\n      <form onSubmit={saveProfile} className=\"space-y-4\">\r\n        <div>\r\n          <label className=\"block font-medium mb-1\">Full Name</label>\r\n          <input\r\n            type=\"text\"\r\n            value={provider.full_name || \"\"}\r\n            onChange={(e) => setProvider({ ...provider, full_name: e.target.value })}\r\n            className=\"w-full border rounded-lg p-2\"\r\n            placeholder=\"Enter your name\"\r\n            required\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block font-medium mb-1\">Phone</label>\r\n          <input\r\n            type=\"text\"\r\n            value={provider.phone || \"\"}\r\n            readOnly\r\n            className=\"w-full border rounded-lg p-2 bg-gray-100 text-gray-500 cursor-not-allowed\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block font-medium mb-1\">District</label>\r\n          <input\r\n            type=\"text\"\r\n            value={provider.district || \"\"}\r\n            onChange={(e) => setProvider({ ...provider, district: e.target.value })}\r\n            className=\"w-full border rounded-lg p-2\"\r\n            placeholder=\"e.g. Beirut\"\r\n          />\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block font-medium mb-1\">Branch</label>\r\n          <select\r\n            value={provider.branch || \"\"}\r\n            onChange={(e) => setProvider({ ...provider, branch: e.target.value })}\r\n            className=\"w-full border rounded-lg p-2\"\r\n          >\r\n            <option value=\"\">Select a branch</option>\r\n            <option value=\"On-site\">On-site</option>\r\n            <option value=\"Online\">Online</option>\r\n            <option value=\"Both\">Both</option>\r\n          </select>\r\n        </div>\r\n\r\n        <div>\r\n          <label className=\"block font-medium mb-1\">Service</label>\r\n          <input\r\n            type=\"text\"\r\n            value={provider.service || \"\"}\r\n            onChange={(e) => setProvider({ ...provider, service: e.target.value })}\r\n            className=\"w-full border rounded-lg p-2\"\r\n            placeholder=\"e.g. Plumbing, Graphic Design...\"\r\n          />\r\n        </div>\r\n\r\n        <button\r\n          type=\"submit\"\r\n          disabled={saving}\r\n          className=\"w-full bg-orange-600 hover:bg-orange-700 text-white py-2 rounded-lg transition disabled:bg-gray-400\"\r\n        >\r\n          {saving ? \"Saving...\" : \"Save Profile\"}\r\n        </button>\r\n      </form>\r\n\r\n      <div className=\"mt-6 text-center\">\r\n        <button\r\n          onClick={toggleAvailability}\r\n          className={`px-4 py-2 rounded-lg font-medium transition ${\r\n            provider.available\r\n              ? \"bg-green-500 hover:bg-green-600 text-white\"\r\n              : \"bg-gray-400 hover:bg-gray-500 text-white\"\r\n          }`}\r\n        >\r\n          {provider.available ? \"Available ‚úÖ\" : \"Unavailable ‚õî\"}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}