{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///D:/Khedme/Khedme-Web/pages/jobs.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { Search, MapPin, Wrench, DollarSign, X } from \"lucide-react\";\r\nimport toast, { Toaster } from \"react-hot-toast\";\r\n\r\nexport default function JobsPage() {\r\n  const [jobs, setJobs] = useState([]);\r\n  const [filtered, setFiltered] = useState([]);\r\n  const [filters, setFilters] = useState({ service: \"\", district: \"\", search: \"\" });\r\n  const [loading, setLoading] = useState(true);\r\n  const [selectedJob, setSelectedJob] = useState(null);\r\n\r\n  // Fetch all jobs\r\n  useEffect(() => {\r\n    const fetchJobs = async () => {\r\n      try {\r\n        const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/api/jobs/all`);\r\n        if (!res.ok) throw new Error(`HTTP ${res.status}`);\r\n        const data = await res.json();\r\n        setJobs(data.jobs || []);\r\n        setFiltered(data.jobs || []);\r\n      } catch (err) {\r\n        console.error(err);\r\n        toast.error(\"Failed to load jobs â€” check backend connection.\");\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchJobs();\r\n  }, []);\r\n\r\n  // Apply filters\r\n  useEffect(() => {\r\n    let temp = [...jobs];\r\n    if (filters.service) temp = temp.filter(j => j.service === filters.service);\r\n    if (filters.district) temp = temp.filter(j => j.district === filters.district);\r\n    if (filters.search)\r\n      temp = temp.filter(j =>\r\n        j.description.toLowerCase().includes(filters.search.toLowerCase())\r\n      );\r\n    setFiltered(temp);\r\n  }, [filters, jobs]);\r\n\r\n  const uniqueServices = [...new Set(jobs.map(j => j.service))];\r\n  const uniqueDistricts = [...new Set(jobs.map(j => j.district))];\r\n\r\n  if (loading)\r\n    return (\r\n      <div className=\"flex items-center justify-center min-h-screen bg-gray-50 text-gray-600\">\r\n        <p>Loading jobs...</p>\r\n      </div>\r\n    );\r\n\r\n  return (\r\n    <>\r\n      <Toaster position=\"top-right\" />\r\n      <div className=\"min-h-screen bg-gray-50 py-10 px-6\">\r\n        <div className=\"max-w-6xl mx-auto\">\r\n          {/* Header */}\r\n          <div className=\"flex flex-col sm:flex-row items-center justify-between mb-8 gap-4\">\r\n            <h1 className=\"text-3xl font-bold text-orange-500 text-center sm:text-left\">\r\n              Available Jobs\r\n            </h1>\r\n          </div>\r\n\r\n          {/* Filters */}\r\n          <div className=\"bg-white rounded-xl shadow-sm p-4 flex flex-wrap gap-3 items-center justify-between mb-6\">\r\n            <input\r\n              type=\"text\"\r\n              placeholder=\"Search description...\"\r\n              className=\"border rounded-lg px-3 py-2 w-full sm:w-64\"\r\n              value={filters.search}\r\n              onChange={(e) => setFilters({ ...filters, search: e.target.value })}\r\n            />\r\n            <select\r\n              className=\"border rounded-lg px-3 py-2\"\r\n              value={filters.service}\r\n              onChange={(e) => setFilters({ ...filters, service: e.target.value })}\r\n            >\r\n              <option value=\"\">All Services</option>\r\n              {uniqueServices.map((s, i) => (\r\n                <option key={i} value={s}>{s}</option>\r\n              ))}\r\n            </select>\r\n            <select\r\n              className=\"border rounded-lg px-3 py-2\"\r\n              value={filters.district}\r\n              onChange={(e) => setFilters({ ...filters, district: e.target.value })}\r\n            >\r\n              <option value=\"\">All Districts</option>\r\n              {uniqueDistricts.map((d, i) => (\r\n                <option key={i} value={d}>{d}</option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          {/* Jobs Grid */}\r\n          {filtered.length === 0 ? (\r\n            <p className=\"text-center text-gray-500\">No jobs match your filters.</p>\r\n          ) : (\r\n            <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n              {filtered.map((job) => (\r\n                <motion.div\r\n                  key={job.id}\r\n                  className=\"bg-white shadow-md rounded-2xl p-5 border border-gray-100 hover:shadow-lg transition cursor-pointer\"\r\n                  whileHover={{ scale: 1.03 }}\r\n                  onClick={() => setSelectedJob(job)}\r\n                >\r\n                  <div className=\"flex items-center gap-2 mb-2 text-orange-500\">\r\n                    <Wrench size={18} />\r\n                    <h2 className=\"text-lg font-semibold\">{job.service}</h2>\r\n                  </div>\r\n                  <p className=\"text-gray-600 mb-1 line-clamp-2\">{job.description}</p>\r\n                  <div className=\"flex items-center text-gray-500 text-sm mt-2 gap-2\">\r\n                    <MapPin size={14} /> {job.district}\r\n                  </div>\r\n                  <div className=\"flex items-center text-orange-600 font-bold mt-1 gap-1\">\r\n                    <DollarSign size={14} /> {job.budget}\r\n                  </div>\r\n                </motion.div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Job Details Modal */}\r\n      <AnimatePresence>\r\n        {selectedJob && (\r\n          <motion.div\r\n            className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n            onClick={() => setSelectedJob(null)}\r\n          >\r\n            <motion.div\r\n              className=\"bg-white rounded-2xl shadow-xl p-6 max-w-md w-full mx-4 relative\"\r\n              initial={{ scale: 0.9, opacity: 0 }}\r\n              animate={{ scale: 1, opacity: 1 }}\r\n              exit={{ scale: 0.9, opacity: 0 }}\r\n              onClick={(e) => e.stopPropagation()}\r\n            >\r\n              <button\r\n                onClick={() => setSelectedJob(null)}\r\n                className=\"absolute top-3 right-3 text-gray-500 hover:text-gray-700\"\r\n              >\r\n                <X size={20} />\r\n              </button>\r\n              <h2 className=\"text-2xl font-bold text-orange-500 mb-2\">\r\n                {selectedJob.service}\r\n              </h2>\r\n              <p className=\"text-gray-700 mb-3\">{selectedJob.description}</p>\r\n              <p className=\"flex items-center gap-2 text-gray-500\">\r\n                <MapPin size={16} /> {selectedJob.district}\r\n              </p>\r\n              <p className=\"flex items-center gap-2 text-orange-600 font-semibold mt-2\">\r\n                <DollarSign size={16} /> {selectedJob.budget} USD\r\n              </p>\r\n              <p className=\"text-xs text-gray-400 mt-4\">\r\n                Posted on {new Date(selectedJob.created_at).toLocaleString()}\r\n              </p>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n    </>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}