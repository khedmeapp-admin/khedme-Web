{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///D:/Khedme/Khedme-Web/pages/post-job.js"],"sourcesContent":["import { useEffect, useState } from \"react\";\r\nimport toast from \"react-hot-toast\";\r\n\r\nexport default function PostJob() {\r\n  const [form, setForm] = useState({\r\n    branch: \"\",\r\n    service: \"\",\r\n    district: \"\",\r\n    description: \"\",\r\n    budget: \"\",\r\n  });\r\n  const [categories, setCategories] = useState([]);\r\n  const [districts, setDistricts] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  // ✅ Fetch meta (categories + districts)\r\n  useEffect(() => {\r\n    const fetchMeta = async () => {\r\n      try {\r\n        const res = await fetch(\"https://khedme-api.onrender.com/api/meta\");\r\n        if (!res.ok) throw new Error(\"Failed to fetch\");\r\n        const data = await res.json();\r\n\r\n        if (data.success) {\r\n          setCategories(data.categories || []);\r\n          setDistricts(data.districts || []);\r\n        } else {\r\n          toast.error(\"Failed to load data\");\r\n        }\r\n      } catch (err) {\r\n        console.error(\"❌ Meta fetch error:\", err);\r\n        toast.error(\"Could not connect to Khedme API\");\r\n      }\r\n    };\r\n    fetchMeta();\r\n  }, []);\r\n\r\n  const handleChange = (e) => {\r\n    setForm({ ...form, [e.target.name]: e.target.value });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoading(true);\r\n    try {\r\n      const res = await fetch(\"https://khedme-api.onrender.com/api/jobs/create\", {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(form),\r\n      });\r\n      const data = await res.json();\r\n\r\n      if (data.job) {\r\n        toast.success(\"Job posted successfully!\");\r\n        setForm({\r\n          branch: \"\",\r\n          service: \"\",\r\n          district: \"\",\r\n          description: \"\",\r\n          budget: \"\",\r\n        });\r\n      } else {\r\n        toast.error(\"Failed to post job\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"❌ Error posting job:\", err);\r\n      toast.error(\"Error posting job\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  // ✅ Filter services based on selected branch\r\n  const filteredServices = form.branch\r\n    ? categories.filter((c) => c.branch === form.branch)\r\n    : [];\r\n\r\n  return (\r\n    <div className=\"max-w-xl mx-auto p-6 bg-white rounded-2xl shadow-md mt-10\">\r\n      <h1 className=\"text-2xl font-semibold text-center text-orange-600 mb-4\">\r\n        Post a Job\r\n      </h1>\r\n\r\n      <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n        {/* Main Branch */}\r\n        <div>\r\n          <label className=\"block font-medium mb-1\">Main Branch</label>\r\n          <select\r\n            name=\"branch\"\r\n            value={form.branch}\r\n            onChange={(e) => {\r\n              handleChange(e);\r\n              setForm((prev) => ({ ...prev, service: \"\" })); // reset service\r\n            }}\r\n            className=\"w-full border rounded-lg p-2\"\r\n            required\r\n          >\r\n            <option value=\"\">Select a branch</option>\r\n            <option value=\"On-site\">On-site</option>\r\n            <option value=\"Online\">Online</option>\r\n            <option value=\"Both\">Both</option>\r\n          </select>\r\n        </div>\r\n\r\n        {/* Service */}\r\n        <div>\r\n          <label className=\"block font-medium mb-1\">Service</label>\r\n          <select\r\n            name=\"service\"\r\n            value={form.service}\r\n            onChange={handleChange}\r\n            className=\"w-full border rounded-lg p-2\"\r\n            required\r\n            disabled={!form.branch}\r\n          >\r\n            <option value=\"\">\r\n              {form.branch ? \"Select a service\" : \"Select a branch first\"}\r\n            </option>\r\n            {filteredServices.map((cat) => (\r\n              <option key={cat.id} value={cat.name}>\r\n                {cat.name} — {cat.name_ar}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n\r\n        {/* District */}\r\n        <div>\r\n          <label className=\"block font-medium mb-1\">District</label>\r\n          <select\r\n            name=\"district\"\r\n            value={form.district}\r\n            onChange={handleChange}\r\n            className=\"w-full border rounded-lg p-2\"\r\n            required\r\n          >\r\n            <option value=\"\">Select a district</option>\r\n            {districts.map((d) => (\r\n              <option key={d.id} value={d.name}>\r\n                {d.name} — {d.name_ar}\r\n              </option>\r\n            ))}\r\n          </select>\r\n        </div>\r\n\r\n        {/* Description */}\r\n        <div>\r\n          <label className=\"block font-medium mb-1\">Description</label>\r\n          <textarea\r\n            name=\"description\"\r\n            value={form.description}\r\n            onChange={handleChange}\r\n            placeholder=\"Describe the task...\"\r\n            className=\"w-full border rounded-lg p-2\"\r\n            rows={3}\r\n            required\r\n          />\r\n        </div>\r\n\r\n        {/* Budget */}\r\n        <div>\r\n          <label className=\"block font-medium mb-1\">Budget (USD)</label>\r\n          <input\r\n            type=\"number\"\r\n            name=\"budget\"\r\n            value={form.budget}\r\n            onChange={handleChange}\r\n            placeholder=\"e.g. 50\"\r\n            className=\"w-full border rounded-lg p-2\"\r\n            required\r\n          />\r\n        </div>\r\n\r\n        {/* Submit */}\r\n        <button\r\n          type=\"submit\"\r\n          disabled={loading}\r\n          className=\"w-full bg-orange-500 hover:bg-orange-600 text-white py-2 rounded-lg transition\"\r\n        >\r\n          {loading ? \"Posting...\" : \"Post Job\"}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}