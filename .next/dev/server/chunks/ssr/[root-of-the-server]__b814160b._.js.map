{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 12, "column": 0}, "map": {"version":3,"sources":["file:///D:/Khedme/Khedme-Web/pages/admin/approve.js"],"sourcesContent":["import { useEffect, useState, useRef } from \"react\";\r\nimport { useRouter } from \"next/router\";\r\nimport { toast } from \"sonner\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport confetti from \"canvas-confetti\";\r\n\r\nexport default function AdminApprove() {\r\n  const [providers, setProviders] = useState([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [selected, setSelected] = useState(null);\r\n  const router = useRouter();\r\n  const modalRef = useRef(null);\r\n\r\n  // âœ… Fetch pending providers\r\n  useEffect(() => {\r\n    const token = localStorage.getItem(\"adminToken\");\r\n    if (!token) {\r\n      router.push(\"/admin/login\");\r\n      return;\r\n    }\r\n\r\n    const fetchProviders = async () => {\r\n      try {\r\n        const res = await fetch(`${process.env.NEXT_PUBLIC_API_URL}/api/providers/pending`);\r\n        const data = await res.json();\r\n        setProviders(data.providers || []);\r\n      } catch (err) {\r\n        console.error(\"Error fetching providers:\", err);\r\n        toast.error(\"Failed to load providers.\", {\r\n          style: { background: \"#FFE4E1\", color: \"#E25822\", border: \"1px solid #E25822\" },\r\n        });\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchProviders();\r\n  }, [router]);\r\n\r\n  // âœ… Close modal when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (modalRef.current && !modalRef.current.contains(event.target)) {\r\n        setSelected(null);\r\n      }\r\n    };\r\n\r\n    if (selected) {\r\n      document.addEventListener(\"mousedown\", handleClickOutside);\r\n    } else {\r\n      document.removeEventListener(\"mousedown\", handleClickOutside);\r\n    }\r\n\r\n    return () => document.removeEventListener(\"mousedown\", handleClickOutside);\r\n  }, [selected]);\r\n\r\n  // âœ… Confetti burst\r\n  const triggerConfetti = () => {\r\n    const duration = 1.2 * 1000;\r\n    const animationEnd = Date.now() + duration;\r\n    const defaults = { startVelocity: 25, spread: 360, ticks: 40, zIndex: 1000 };\r\n\r\n    const interval = setInterval(() => {\r\n      const timeLeft = animationEnd - Date.now();\r\n      if (timeLeft <= 0) return clearInterval(interval);\r\n\r\n      const particleCount = 50 * (timeLeft / duration);\r\n      confetti({\r\n        ...defaults,\r\n        particleCount,\r\n        origin: { x: Math.random(), y: Math.random() - 0.2 },\r\n      });\r\n    }, 150);\r\n  };\r\n\r\n  // âœ… Approve or Reject\r\n  const handleAction = async (id, action) => {\r\n    try {\r\n      const endpoint = `${process.env.NEXT_PUBLIC_API_URL}/api/providers/${action}`;\r\n      const res = await fetch(endpoint, {\r\n        method: \"POST\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify({ provider_id: id }),\r\n      });\r\n\r\n      const data = await res.json();\r\n      if (!res.ok) throw new Error(data.message);\r\n\r\n      setProviders((prev) => prev.filter((p) => p.id !== id));\r\n      setSelected(null);\r\n\r\n      if (action === \"approve\") triggerConfetti();\r\n\r\n      toast.success(\r\n        action === \"approve\" ? \"âœ… Provider approved!\" : \"âŒ Provider rejected!\",\r\n        {\r\n          style: { background: \"#FFF2E5\", color: \"#E25822\", border: \"1px solid #E25822\" },\r\n        }\r\n      );\r\n    } catch (err) {\r\n      console.error(\"Action error:\", err);\r\n      toast.error(err.message || \"Action failed.\", {\r\n        style: { background: \"#FFE4E1\", color: \"#E25822\", border: \"1px solid #E25822\" },\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem(\"adminToken\");\r\n    toast(\"ðŸ‘‹ Logged out\", {\r\n      style: { background: \"#FFF2E5\", color: \"#E25822\", border: \"1px solid #E25822\" },\r\n    });\r\n    router.push(\"/admin/login\");\r\n  };\r\n\r\n  if (loading) return <div className=\"text-center mt-20 text-orange-500\">Loading providers...</div>;\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-orange-50 p-8\">\r\n      <div className=\"flex justify-between items-center mb-6\">\r\n        <h1 className=\"text-xl font-semibold text-orange-600\">Pending Providers</h1>\r\n        <button\r\n          onClick={handleLogout}\r\n          className=\"text-sm px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition\"\r\n        >\r\n          Logout\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"bg-white shadow rounded-xl border border-orange-100 overflow-hidden\">\r\n        <table className=\"w-full text-left border-collapse\">\r\n          <thead className=\"bg-orange-100 text-orange-700\">\r\n            <tr>\r\n              <th className=\"py-3 px-4\">Name</th>\r\n              <th className=\"py-3 px-4\">Phone</th>\r\n              <th className=\"py-3 px-4\">Branch</th>\r\n              <th className=\"py-3 px-4\">Service</th>\r\n              <th className=\"py-3 px-4\">District</th>\r\n              <th className=\"py-3 px-4 text-center\">Actions</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {providers.length === 0 ? (\r\n              <tr>\r\n                <td colSpan=\"6\" className=\"text-center py-6 text-gray-500\">\r\n                  No pending providers ðŸŽ‰\r\n                </td>\r\n              </tr>\r\n            ) : (\r\n              providers.map((p) => (\r\n                <tr key={p.id} className=\"border-t hover:bg-orange-50\">\r\n                  <td\r\n                    onClick={() => setSelected(p)}\r\n                    className=\"py-3 px-4 text-orange-600 font-medium cursor-pointer hover:underline\"\r\n                  >\r\n                    {p.name}\r\n                  </td>\r\n                  <td className=\"py-3 px-4\">{p.phone}</td>\r\n                  <td className=\"py-3 px-4\">{p.branch || \"â€”\"}</td>\r\n                  <td className=\"py-3 px-4\">{p.service || \"â€”\"}</td>\r\n                  <td className=\"py-3 px-4\">{p.district || \"â€”\"}</td>\r\n                  <td className=\"py-3 px-4 text-center space-x-2\">\r\n                    <motion.button\r\n                      whileHover={{ scale: 1.08 }}\r\n                      whileTap={{ scale: 0.95 }}\r\n                      onClick={() => handleAction(p.id, \"approve\")}\r\n                      className=\"px-3 py-1 bg-orange-500 text-white rounded-md hover:bg-orange-600 text-sm\"\r\n                    >\r\n                      Approve\r\n                    </motion.button>\r\n                    <motion.button\r\n                      whileHover={{ scale: 1.08 }}\r\n                      whileTap={{ scale: 0.95 }}\r\n                      onClick={() => handleAction(p.id, \"reject\")}\r\n                      className=\"px-3 py-1 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 text-sm\"\r\n                    >\r\n                      Reject\r\n                    </motion.button>\r\n                  </td>\r\n                </tr>\r\n              ))\r\n            )}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n\r\n      {/* âœ… Animated Modal */}\r\n      <AnimatePresence>\r\n        {selected && (\r\n          <motion.div\r\n            key=\"overlay\"\r\n            className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\"\r\n            initial={{ opacity: 0 }}\r\n            animate={{ opacity: 1 }}\r\n            exit={{ opacity: 0 }}\r\n          >\r\n            <motion.div\r\n              key=\"modal\"\r\n              ref={modalRef}\r\n              initial={{ opacity: 0, y: 40, scale: 0.95 }}\r\n              animate={{ opacity: 1, y: 0, scale: 1 }}\r\n              exit={{ opacity: 0, y: 40, scale: 0.95 }}\r\n              transition={{ duration: 0.3, ease: \"easeOut\" }}\r\n              className=\"bg-white rounded-xl shadow-lg p-6 w-full max-w-md border border-orange-200 relative\"\r\n            >\r\n              <button\r\n                onClick={() => setSelected(null)}\r\n                className=\"absolute top-3 right-3 text-gray-500 hover:text-gray-700\"\r\n              >\r\n                âœ•\r\n              </button>\r\n\r\n              <h2 className=\"text-xl font-semibold text-orange-600 mb-4 text-center\">\r\n                Provider Details\r\n              </h2>\r\n\r\n              <div className=\"space-y-2 text-gray-700\">\r\n                <p><strong>Name:</strong> {selected.name}</p>\r\n                <p><strong>Phone:</strong> {selected.phone}</p>\r\n                <p><strong>Branch:</strong> {selected.branch || \"â€”\"}</p>\r\n                <p><strong>Service:</strong> {selected.service || \"â€”\"}</p>\r\n                <p><strong>District:</strong> {selected.district || \"â€”\"}</p>\r\n                <p><strong>Created At:</strong> {selected.created_at?.split(\"T\")[0] || \"â€”\"}</p>\r\n              </div>\r\n\r\n              <div className=\"flex justify-end space-x-3 mt-6\">\r\n                <motion.button\r\n                  whileHover={{ scale: 1.08 }}\r\n                  whileTap={{ scale: 0.95 }}\r\n                  onClick={() => handleAction(selected.id, \"approve\")}\r\n                  className=\"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600\"\r\n                >\r\n                  Approve\r\n                </motion.button>\r\n                <motion.button\r\n                  whileHover={{ scale: 1.08 }}\r\n                  whileTap={{ scale: 0.95 }}\r\n                  onClick={() => handleAction(selected.id, \"reject\")}\r\n                  className=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300\"\r\n                >\r\n                  Reject\r\n                </motion.button>\r\n              </div>\r\n            </motion.div>\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}